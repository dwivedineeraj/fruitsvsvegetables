<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üçé Fruits vs Vegetables Battle - Fun Nutrition Game for Kids ü•¨</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#4f46e5">
    <meta name="description" content="üéÆ Help kids learn healthy eating through fun! Interactive nutrition game where children discover amazing facts about fruits and vegetables. Perfect educational tool for parents teaching healthy habits. Safe, ad-free learning!">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Nutrition Battle">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- SEO Meta Tags -->
    <meta name="keywords" content="kids nutrition game, children vegetables fruits, educational food game, healthy eating kids, nutrition learning children, parents teaching nutrition, interactive food education, fruits vs vegetables kids, healthy eating habits children, fun nutrition activities">
    <meta name="author" content="Nutrition Battle Game">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Fruits vs Vegetables Battle - Fun Nutrition Game for Kids">
    <meta property="og:description" content="Help kids learn healthy eating! Interactive nutrition game where children discover amazing facts about fruits and vegetables through fun battles. Perfect for parents teaching healthy habits!">
    <meta property="og:image" content="./frontend/icons/icon-512.png">
    <meta property="og:url" content="">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Kids Nutrition Game - Fruits vs Vegetables">
    <meta name="twitter:description" content="üçéü•¨ Fun educational game teaching kids about healthy eating! Parents love it, kids enjoy learning nutrition facts through interactive battles.">
    <meta name="twitter:image" content="./frontend/icons/icon-512.png">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="./frontend/manifest.json">
    
    <!-- PWA Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="./frontend/icons/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="./frontend/icons/icon-512.png">
    <link rel="apple-touch-icon" href="./frontend/icons/icon-192.png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'fruit-red': '#ff6b6b',
                        'fruit-orange': '#ffa726',
                        'fruit-green': '#66bb6a',
                        'fruit-purple': '#ab47bc',
                        'fruit-yellow': '#ffee58'
                    }
                }
            }
        }
    </script>
    <style>
        .card-flip {
            transition: transform 0.3s ease;
        }
        .card-flip:hover {
            transform: scale(1.05);
        }
        .bounce-in {
            animation: bounceIn 0.5s ease;
        }
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        /* Victory celebration animation */
        @keyframes celebrate {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.1) rotate(-5deg); }
            75% { transform: scale(1.1) rotate(5deg); }
        }
        
        .celebrate {
            animation: celebrate 0.6s ease-in-out infinite;
        }
        
        /* Pulse animation for interactive elements */
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(59, 130, 246, 0.5); }
            50% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.8), 0 0 30px rgba(59, 130, 246, 0.6); }
        }
        
        .glow {
            animation: glow 2s ease-in-out infinite;
        }
        
        /* Smooth transitions for all interactive elements */
        * {
            transition: all 0.2s ease;
        }
        
        /* Hide scrollbar for horizontal scroll */
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        
        /* Header z-index above modals */
        .header-above-modals {
            z-index: 1100;
        }
        
        /* Mobile optimizations */
        .mobile-touch-improvements {
            -webkit-overflow-scrolling: touch;
        }
        
        /* iOS Safari viewport fix */
        @supports (-webkit-touch-callout: none) {
            .ios-viewport-fix {
                min-height: -webkit-fill-available;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-green-100 via-yellow-50 to-orange-100 min-h-screen overflow-x-hidden ios-viewport-fix">
    <!-- Header -->
    <header class="bg-white shadow-lg p-3 md:p-4 sticky top-0 header-above-modals">
        <div class="max-w-4xl mx-auto flex items-center justify-between">
            <!-- Logo Section -->
            <div class="flex items-center space-x-3 md:space-x-4">
                <img src="./frontend/icons/icon.png" alt="Nutrition Battle" class="w-16 h-16 md:w-20 md:h-20 rounded-full shadow-xl flex-shrink-0">
                <div class="min-w-0">
                    <h1 class="text-base md:text-xl font-bold text-gray-800 truncate">Fruits vs Vegetables!</h1>
                    <p class="text-xs md:text-sm text-gray-600 hidden sm:block">First to 4 wins!</p>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex items-center space-x-2 md:space-x-3">
                <!-- Profile Button -->
                <button id="profileBtn" class="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-3 px-3 md:px-4 rounded-full text-xs md:text-sm shadow-lg transform transition hover:scale-105 flex items-center justify-center space-x-1 md:space-x-2 min-h-[52px] min-w-[52px]">
                    <svg class="w-5 h-5 md:w-4 md:h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    <span class="hidden sm:inline">Profile</span>
                </button>
                
                <!-- Restart Button -->
                <button id="restartGameBtn" class="bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold py-3 px-3 md:px-4 rounded-full text-xs md:text-sm shadow-lg transform transition hover:scale-105 flex items-center justify-center space-x-1 md:space-x-2 min-h-[52px] min-w-[52px]">
                    <svg class="w-5 h-5 md:w-4 md:h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                    <span class="hidden sm:inline">Restart</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Game Container -->
    <div class="max-w-4xl mx-auto px-2 md:px-4 pb-2 max-h-screen overflow-y-auto mobile-touch-improvements">
        
        <!-- Score Board -->
        <div class="bg-white rounded-lg shadow-lg p-2 md:p-4 mb-2 md:mb-4">
            <div class="flex justify-between items-center">
                <div class="text-center">
                    <h3 class="text-sm md:text-lg font-bold text-blue-600">You üë§</h3>
                    <div class="text-xl md:text-2xl font-bold text-blue-700" id="player1Score">0</div>
                    <div class="flex mt-1 justify-center space-x-1" id="player1Stars">
                        <!-- Stars will be added dynamically -->
                    </div>
                </div>
                
                <div class="text-center">
                    <div class="text-xs md:text-sm font-semibold text-gray-500">VS</div>
                    <div class="text-xs text-gray-400" id="currentPlayerIndicator">Your Turn</div>
                </div>
                
                <div class="text-center">
                    <h3 class="text-sm md:text-lg font-bold text-red-600">Computer ü§ñ</h3>
                    <div class="text-xl md:text-2xl font-bold text-red-700" id="player2Score">0</div>
                    <div class="flex mt-1 justify-center space-x-1" id="player2Stars">
                        <!-- Stars will be added dynamically -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Area -->
        <div id="gameArea" class="space-y-3 md:space-y-4">
            
            <!-- Cards Display - Now with more space -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4">
                <!-- Player Card -->
                <div class="bg-blue-50 rounded-lg p-3 md:p-4 border border-blue-200">
                    <h4 class="text-sm md:text-base font-bold text-blue-800 mb-2 text-center">Your Card üë§</h4>
                    <div id="player1Card" class="bg-white rounded-lg p-3 md:p-4 shadow-md card-flip">
                        <div class="text-center text-gray-500">
                            <div class="text-4xl md:text-6xl mb-2">üÉè</div>
                            <div class="text-sm md:text-base">Waiting for cards...</div>
                        </div>
                    </div>
                </div>

                <!-- Computer Card -->
                <div class="bg-red-50 rounded-lg p-3 md:p-4 border border-red-200">
                    <h4 class="text-sm md:text-base font-bold text-red-800 mb-2 text-center">Computer's Card ü§ñ</h4>
                    <div id="player2Card" class="bg-white rounded-lg p-3 md:p-4 shadow-md card-flip">
                        <div class="text-center text-gray-500">
                            <div class="text-4xl md:text-6xl mb-2">üÉè</div>
                            <div class="text-sm md:text-base">Waiting for cards...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Attribute Selection -->
            <div id="attributeSelection" class="bg-white rounded-lg shadow-lg p-2 md:p-4" style="display: none;">
                <h3 class="text-xl font-bold text-center mb-4 text-gray-800">Choose an Attribute to Compare!</h3>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-3" id="attributeButtons">
                    <!-- Attribute buttons will be added dynamically -->
                </div>
            </div>

        </div>

        <!-- Fruit Selection Modal -->
        <div id="fruitSelectionModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-2" style="display: none; z-index: 1000;">
            <div class="bg-white rounded-lg p-3 md:p-4 max-w-2xl w-full max-h-[90vh] md:max-h-[80vh] overflow-y-auto overscroll-contain">
                <div id="fruitSelectionContent">
                    <!-- Content will be dynamically generated -->
                </div>
            </div>
        </div>

        <!-- Game Over Modal -->
        <div id="gameOverModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4" style="display: none; z-index: 1000;">
            <div class="bg-white rounded-lg p-4 md:p-6 max-w-sm w-full text-center shadow-2xl max-h-[90vh] overflow-y-auto">
                <div class="text-3xl md:text-5xl mb-2 md:mb-3">üéâ</div>
                <h2 class="text-lg md:text-2xl font-bold mb-2 md:mb-3" id="winnerMessage">You Win!</h2>
                <p class="text-gray-600 mb-3 md:mb-4 text-xs md:text-sm">Congratulations on learning about fruits!</p>
                <button id="playAgainBtn" class="bg-fruit-green hover:bg-green-500 text-white font-bold py-2 px-4 rounded-lg text-sm shadow-lg transform transition hover:scale-105">
                    üîÑ Play Again
                </button>
            </div>
        </div>

    </div>

    <!-- Educational Value & Safety Notice for Parents -->
    <footer class="bg-white border-t border-gray-200 py-4 text-center">
        <div class="max-w-4xl mx-auto px-4">
            <div class="flex flex-wrap justify-center items-center space-x-6 text-xs text-gray-600">
                <span class="flex items-center space-x-1">
                    <span>üõ°Ô∏è</span>
                    <span>Safe for Kids</span>
                </span>
                <span class="flex items-center space-x-1">
                    <span>üéì</span>
                    <span>Educational Content</span>
                </span>
                <span class="flex items-center space-x-1">
                    <span>üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span>
                    <span>Parent Approved</span>
                </span>
                <span class="flex items-center space-x-1">
                    <span>ü•ó</span>
                    <span>Real Nutrition Facts</span>
                </span>
            </div>
            <p class="text-xs text-gray-500 mt-2">Teaching healthy eating habits through interactive learning ‚Ä¢ Ages 6+</p>
        </div>
    </footer>

    <!-- Game Logic Script -->
    <script src="frontend/game-ui.js"></script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        // Mobile touch event improvements
        document.addEventListener('DOMContentLoaded', function() {
            // Mobile debug info (remove after testing)
            if (window.innerWidth <= 768) {
                console.log('Mobile device detected:', {
                    width: window.innerWidth,
                    height: window.innerHeight,
                    userAgent: navigator.userAgent,
                    touchSupport: 'ontouchstart' in window
                });
                
                // Add visible debug info for mobile
                const debugDiv = document.createElement('div');
                debugDiv.className = 'fixed top-0 left-0 bg-red-500 bg-opacity-80 text-white p-2 text-xs z-[9999] max-w-[200px] rounded-br-lg';
                debugDiv.innerHTML = `Mobile: ${window.innerWidth}x${window.innerHeight}<br>Touch: ${('ontouchstart' in window) ? 'Yes' : 'No'}`;
                document.body.appendChild(debugDiv);
                
                // Remove debug after 5 seconds
                setTimeout(() => debugDiv.remove(), 5000);
            }
            
            // Add text-base class to all text inputs to prevent zoom on focus (iOS)
            document.querySelectorAll('input[type="text"]').forEach(input => {
                input.classList.add('text-base', 'min-h-[44px]');
            });
            
            // Prevent double-tap zoom on buttons
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function (event) {
                const now = (new Date()).getTime();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, false);
            
            // Add active states for better mobile feedback
            document.addEventListener('touchstart', function(e) {
                if (e.target.matches('button, .attribute-stat-btn, .user-icon-btn')) {
                    e.target.style.transform = 'scale(0.95)';
                }
            });
            
            document.addEventListener('touchend', function(e) {
                if (e.target.matches('button, .attribute-stat-btn, .user-icon-btn')) {
                    setTimeout(() => {
                        e.target.style.transform = '';
                    }, 100);
                }
            });
        });
        
        // Register service worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./frontend/sw.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
        
        // PWA Installation Prompt
        let deferredPrompt;
        let installButton = null;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('PWA install prompt triggered');
            // Prevent Chrome 67 and earlier from automatically showing the prompt
            e.preventDefault();
            // Stash the event so it can be triggered later
            deferredPrompt = e;
            
            // Show install button in header if not already installed
            showInstallButton();
        });
        
        function showInstallButton() {
            // Create install button if it doesn't exist
            if (!installButton && deferredPrompt) {
                const header = document.querySelector('header .flex.items-center.space-x-3');
                installButton = document.createElement('button');
                installButton.innerHTML = `
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8l-8-8-8 8"></path>
                    </svg>
                    <span>Install</span>
                `;
                installButton.className = 'bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-2 px-4 rounded-full text-sm shadow-lg transform transition hover:scale-105 flex items-center space-x-2';
                installButton.onclick = installPWA;
                
                // Insert before profile button
                header.insertBefore(installButton, header.firstChild);
            }
        }
        
        function installPWA() {
            if (deferredPrompt) {
                // Show the prompt
                deferredPrompt.prompt();
                // Wait for the user to respond to the prompt
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the PWA install prompt');
                        // Hide install button
                        if (installButton) {
                            installButton.style.display = 'none';
                        }
                    } else {
                        console.log('User dismissed the PWA install prompt');
                    }
                    deferredPrompt = null;
                });
            }
        }
        
        // Hide install button when app is installed
        window.addEventListener('appinstalled', (evt) => {
            console.log('PWA was installed');
            if (installButton) {
                installButton.style.display = 'none';
            }
        });
        
        // Check if already running as PWA
        if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true) {
            console.log('App is running as PWA');
            // Could add PWA-specific features here
        }
    </script>
</body>
</html> 